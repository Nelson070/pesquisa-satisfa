<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesquisa de SatisfaÃ§Ã£o | Feedback</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .hidden {
            display: none !important;
        }
        .active {
            box-shadow: 0 0 0 2px rgb(255, 0, 0);
            border-color: rgb(248, 0, 0);
        }
        
         .loader {
            width: 1.25rem; 
            height: 1.25rem; 
            border: 2px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="flex items-center justify-center p-4 min-h-screen bg-gray-100">
    <div class="w-full max-w-2xl bg-white rounded-xl shadow-xl overflow-hidden">
        <div class="bg-gradient-to-r from-red-600 to-black p-6 text-white">
            <div class="flex items-center mb-4">
                <img src="img/logo maquisul pequena.png" class="w-28 h-auto" alt="Logo Maquisul">
                <div class="ml-4">
                    <h1 class="text-2xl font-bold">Pesquisa de SatisfaÃ§Ã£o Maquisul</h1>
                    <p class="text-red-100">A sua opiniÃ£o Ã© muito importante para nÃ³s!</p>
                </div>
            </div>
            <div class="w-full bg-black/30 rounded-full h-1.5">
                <div id="progress" class="bg-white h-1.5 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <form id="surveyForm" class="p-6" novalidate>
            
            <div id="step1" class="step">
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Qual foi o motivo do seu contato com a empresa?</h2>
                    <p class="text-gray-600 mb-4">Selecione 1 opÃ§Ã£o</p>
                    <div class="space-y-3">
                        
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-red-50 cursor-pointer"><input type="radio" name="contact_reason" value="compra_pj" class="h-5 w-5 text-red-600" required><span class="ml-3 text-gray-700 flex items-center"><i class="fas fa-building w-5 mr-2 text-gray-500"></i>Compra - PJ</span></label>
                        
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-red-50 cursor-pointer"><input type="radio" name="contact_reason" value="compra_pf" class="h-5 w-5 text-red-600" required><span class="ml-3 text-gray-700 flex items-center"><i class="fas fa-user w-5 mr-2 text-gray-500"></i>Compra - PF</span></label>
                        
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-red-50 cursor-pointer"><input type="radio" name="contact_reason" value="suporte" class="h-5 w-5 text-red-600" required><span class="ml-3 text-gray-700 flex items-center"><i class="fas fa-headset w-5 mr-2 text-gray-500"></i>Suporte TÃ©cnico</span></label>
                        
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-red-50 cursor-pointer"><input type="radio" name="contact_reason" value="reclamacao" class="h-5 w-5 text-red-600" required><span class="ml-3 text-gray-700 flex items-center"><i class="fas fa-bullhorn w-5 mr-2 text-gray-500"></i>ReclamaÃ§Ã£o</span></label>
                        
                        <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-red-50 cursor-pointer"><input type="radio" name="contact_reason" value="outro" class="h-5 w-5 text-red-600"><span class="ml-3 text-gray-700 flex items-center"><i class="fas fa-ellipsis w-5 mr-2 text-gray-500"></i>Outro</span></label>
                        <input type="text" name="other_reason" placeholder="Especifique..." class="border border-gray-300 rounded-md p-2 mt-2 w-full hidden">
                    </div>
                    <p id="error-step1" class="text-red-600 text-sm mt-2 hidden"></p>
                </div>
            </div>
            
          
            <div id="stepSuporte" class="step hidden">
                <p id="error-stepSuporte" class="text-red-600 text-sm mb-4 hidden">Por favor, responda a todas as perguntas.</p>
                
              
                <div class="mb-8">
                    <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia o tempo de espera para ser atendido?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                            <button type="button" class="rating-btn-suporte-espera flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                            <button type="button" class="rating-btn-suporte-espera flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                            <button type="button" class="rating-btn-suporte-espera flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                            <button type="button" class="rating-btn-suporte-espera flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                            <button type="button" class="rating-btn-suporte-espera flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                    <div id="motivoSuporteEsperaContainer" class="hidden mt-4 p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                        <div class="space-y-2 text-gray-700">
                            <label class="flex items-center"><input type="checkbox" name="motivo_suporte_espera" value="Esperei muito" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Esperei muito</span></label>
                            <label class="flex items-center"><input type="checkbox" name="motivo_suporte_espera" value="Demorou alÃ©m do esperado" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Demorou alÃ©m do esperado</span></label>
                            <label class="flex items-center"><input type="checkbox" name="motivo_suporte_espera" value="Atendimento lento" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Atendimento lento</span></label>
                            <label class="flex items-center"><input type="checkbox" name="motivo_suporte_espera" value="Muito burocrÃ¡tico" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Muito burocrÃ¡tico</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="suporte_rating_espera" name="suporte_rating_espera">
                </div>
                <hr class="my-8 border-gray-200">
                
             
                <div class="mb-8">
                    <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia a clareza das explicaÃ§Ãµes?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                            <button type="button" class="rating-btn-suporte-clareza flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                            <button type="button" class="rating-btn-suporte-clareza flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                            <button type="button" class="rating-btn-suporte-clareza flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                            <button type="button" class="rating-btn-suporte-clareza flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                            <button type="button" class="rating-btn-suporte-clareza flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                    <div id="motivoSuporteClarezaContainer" class="hidden mt-4 p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                        <div class="space-y-2 text-gray-700">
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_clareza" value="NÃ£o entendi bem" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">NÃ£o entendi bem</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_clareza" value="ExplicaÃ§Ãµes confusas" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">ExplicaÃ§Ãµes confusas</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_clareza" value="Faltou clareza" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Faltou clareza</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="suporte_rating_clareza" name="suporte_rating_clareza">
                </div>
                <hr class="my-8 border-gray-200">
                
                
                <div class="mb-8">
                     <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia a resoluÃ§Ã£o do seu problema?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                           <button type="button" class="rating-btn-suporte-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                           <button type="button" class="rating-btn-suporte-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                           <button type="button" class="rating-btn-suporte-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                           <button type="button" class="rating-btn-suporte-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                           <button type="button" class="rating-btn-suporte-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                    <div id="motivoSuporteResolucaoContainer" class="hidden mt-4 p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                        <div class="space-y-2 text-gray-700">
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_resolucao" value="NÃ£o resolveram" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">NÃ£o resolveram</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_resolucao" value="Problema continua" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Problema continua</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_resolucao" value="Fiquei sem soluÃ§Ã£o" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Fiquei sem soluÃ§Ã£o</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_resolucao" value="Prometeram retornar e nÃ£o cumpriram" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Prometeram retornar e nÃ£o cumpriram</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="suporte_rating_resolucao" name="suporte_rating_resolucao">
                </div>
                <hr class="my-8 border-gray-200">

          
                <div class="mb-8">
                     <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia o tempo para resolver a sua demanda?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                           <button type="button" class="rating-btn-suporte-tempo-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                           <button type="button" class="rating-btn-suporte-tempo-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                           <button type="button" class="rating-btn-suporte-tempo-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                           <button type="button" class="rating-btn-suporte-tempo-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                           <button type="button" class="rating-btn-suporte-tempo-resolucao flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                    <div id="motivoSuporteTempoResolucaoContainer" class="hidden mt-4 p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                        <div class="space-y-2 text-gray-700">
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_tempo_resolucao" value="Demorou demais" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Demorou demais</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_tempo_resolucao" value="Processo lento" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Processo lento</span></label>
                           <label class="flex items-center"><input type="checkbox" name="motivo_suporte_tempo_resolucao" value="Muito tempo gasto" class="h-4 w-4 text-red-600 rounded"><span class="ml-2">Muito tempo gasto</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="suporte_rating_tempo_resolucao" name="suporte_rating_tempo_resolucao">
                </div>
            </div>

            
            <div id="step2" class="step hidden">
                 <p id="error-step2" class="text-red-600 text-sm mb-4 hidden">Por favor, responda a todas as perguntas de avaliaÃ§Ã£o.</p>
                
                 <div class="mb-8">
                    <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia o nosso atendimento?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                            <button type="button" class="rating-btn-geral flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                            <button type="button" class="rating-btn-geral flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                            <button type="button" class="rating-btn-geral flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                            <button type="button" class="rating-btn-geral flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                            <button type="button" class="rating-btn-geral flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                    <div id="motivoGeralContainer" class="hidden p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                        <div class="space-y-2 text-gray-700">
                            <label class="flex items-center"><input type="checkbox" name="motivo_geral" value="Demora no atendimento"><span class="ml-2">Demora no atendimento</span></label>
                            <label class="flex items-center"><input type="checkbox" name="motivo_geral" value="Vendedor nÃ£o demonstrou conhecimento"><span class="ml-2">Vendedor nÃ£o demonstrou conhecimento</span></label>
                            <label class="flex items-center"><input type="checkbox" name="motivo_geral" value="Falta de cordialidade/simpatia"><span class="ml-2">Falta de cordialidade/simpatia</span></label>
                            <label class="flex items-center"><input type="checkbox" name="motivo_geral" value="NÃ£o resolveu o meu problema"><span class="ml-2">NÃ£o resolveu o meu problema</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="rating_geral" name="rating_geral">
                </div>
                <hr class="my-8 border-gray-200">

                
                 <div class="mb-8">
                    <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia o atendimento do caixa?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                           <button type="button" class="rating-btn-caixa flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                           <button type="button" class="rating-btn-caixa flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                           <button type="button" class="rating-btn-caixa flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                           <button type="button" class="rating-btn-caixa flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                           <button type="button" class="rating-btn-caixa flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                    <div id="motivoCaixaContainer" class="hidden p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                         <div class="space-y-2 text-gray-700">
                             <label class="flex items-center"><input type="checkbox" name="motivo_caixa" value="Demora na fila / no caixa"><span class="ml-2">Demora na fila / no caixa</span></label>
                             <label class="flex items-center"><input type="checkbox" name="motivo_caixa" value="Erro na cobranÃ§a"><span class="ml-2">Erro na cobranÃ§a</span></label>
                             <label class="flex items-center"><input type="checkbox" name="motivo_caixa" value="Falta de opÃ§Ãµes de pagamento"><span class="ml-2">Falta de opÃ§Ãµes de pagamento</span></label>
                             <label class="flex items-center"><input type="checkbox" name="motivo_caixa" value="Atendimento pouco cordial"><span class="ml-2">Atendimento pouco cordial</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="rating_caixa" name="rating_caixa">
                </div>
                <hr class="my-8 border-gray-200">

                 
                 <div class="mb-8">
                    <div class="flex flex-col mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 mb-2">Como avalia o momento da entrega?</h2>
                        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                           <button type="button" class="rating-btn-entrega flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="1"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">PÃ©ssimo</span></button>
                           <button type="button" class="rating-btn-entrega flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="2"><span class="text-3xl mb-1">ğŸ˜•</span><span class="text-sm font-medium">Ruim</span></button>
                           <button type="button" class="rating-btn-entrega flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="3"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Regular</span></button>
                           <button type="button" class="rating-btn-entrega flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="4"><span class="text-3xl mb-1">ğŸ˜Š</span><span class="text-sm font-medium">Bom</span></button>
                           <button type="button" class="rating-btn-entrega flex flex-col items-center justify-center p-3 rounded-lg bg-gray-50 hover:bg-red-50 border" data-value="5"><span class="text-3xl mb-1">ğŸ˜</span><span class="text-sm font-medium">Excelente</span></button>
                        </div>
                    </div>
                     <div id="motivoEntregaContainer" class="hidden p-4 border border-red-200 rounded-lg bg-red-50/50">
                        <label class="block text-sm font-bold text-red-600 mb-3">Poderia informar-nos o motivo?</label>
                         <div class="space-y-2 text-gray-700">
                             <label class="flex items-center"><input type="checkbox" name="motivo_entrega" value="Atraso na entrega"><span class="ml-2">Atraso na entrega</span></label>
                             <label class="flex items-center"><input type="checkbox" name="motivo_entrega" value="Produto avariado/danificado"><span class="ml-2">Produto avariado/danificado</span></label>
                             <label class="flex items-center"><input type="checkbox" name="motivo_entrega" value="Entregador pouco profissional"><span class="ml-2">Entregador pouco profissional</span></label>
                             <label class="flex items-center"><input type="checkbox" name="motivo_entrega" value="Falta de comunicaÃ§Ã£o sobre a entrega"><span class="ml-2">Falta de comunicaÃ§Ã£o sobre a entrega</span></label>
                        </div>
                    </div>
                    <input type="hidden" id="rating_entrega" name="rating_entrega">
                </div>
            </div>

     
            <div id="step3" class="step hidden">
                <div class="mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">O que podemos melhorar?</h2>
                    <textarea name="suggestion" rows="4" class="w-full px-4 py-3 border rounded-lg" placeholder="Digite a sua sugestÃ£o aqui..."></textarea>
                </div>
            </div>

     
            <div id="step4" class="step hidden">
                 <div class="mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Dados de contacto (opcional)</h2>
                    <div class="space-y-4">
                        <div><label for="name" class="block text-sm font-medium text-gray-700">Nome</label><input type="text" id="name" name="name" class="w-full px-4 py-3 border rounded-lg"></div>
                        <div><label for="email" class="block text-sm font-medium text-gray-700">E-mail</label><input type="email" id="email" name="email" class="w-full px-4 py-3 border rounded-lg"></div>
                        <div><label for="phone" class="block text-sm font-medium text-gray-700">Telefone</label><input type="tel" id="phone" name="phone" class="w-full px-4 py-3 border rounded-lg"></div>
                    </div>
                </div>
            </div>

        
            <div class="flex justify-between mt-8">
                <button type="button" id="prevBtn" class="hidden px-6 py-3 text-red-600 font-medium rounded-lg hover:bg-red-50"> Voltar</button>
                <button type="button" id="nextBtn" class="ml-auto px-6 py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700">AvanÃ§ar</button>
                <button type="submit" id="submitBtn" class="hidden ml-auto px-6 py-3 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700">Enviar pesquisa</button>
            </div>         
            <p id="error-submit" class="text-red-600 text-sm mt-2 text-right hidden"></p> 
        </form>

        
        <div id="thankYou" class="thank-you p-8 text-center hidden">
            <img src="img/bd17e749-3f02-46e7-9a4c-1e8c35035904.jpeg" alt="boneco joey" class="mx-auto mb-4 w-48">
            <h2 class="text-2xl font-bold">Obrigado pelo seu feedback!</h2>
            <p class="text-gray-600 mt-2">A sua opiniÃ£o Ã© muito valiosa para nÃ³s.</p>
            <p id="redirectMessage" class="text-gray-500 text-sm mt-4">SerÃ¡ redirecionado para a pÃ¡gina inicial em 5 segundos...</p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('surveyForm');
        const allSteps = document.querySelectorAll('.step');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const progressBar = document.getElementById('progress');
        const thankYou = document.getElementById('thankYou');

       
        const nextBtnHTML = nextBtn.innerHTML;
        const submitBtnHTML = submitBtn.innerHTML;

        
        const errorStep1 = document.getElementById('error-step1');
        const errorStepSuporte = document.getElementById('error-stepSuporte');
        const errorStep2 = document.getElementById('error-step2');
        const errorSubmit = document.getElementById('error-submit');
        
        let currentStepId = 'step1';

        const flowMap = {
            general: ['step1', 'step2', 'step3', 'step4'],
            suporte: ['step1', 'stepSuporte', 'step3', 'step4'],
            reclamacao: ['step1', 'step3', 'step4']
        };
        let currentFlow = flowMap.general;

        const getStepElement = (id) => document.getElementById(id);

        function setupRatingButtons(selector, hiddenInputId, motivoContainerId) {
            const buttons = document.querySelectorAll(selector);
            const hiddenInput = document.getElementById(hiddenInputId);
            const motivoContainer = motivoContainerId ? document.getElementById(motivoContainerId) : null;
            if (!hiddenInput) return;

            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    buttons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    hiddenInput.value = this.dataset.value;
                    
                    if (motivoContainer) {
                        const valor = parseInt(this.dataset.value);
                        motivoContainer.classList.toggle('hidden', valor > 3);
                        if (valor > 3) {
                            motivoContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                        }
                    }
                });
            });
        }
        
      
        setupRatingButtons('.rating-btn-suporte-espera', 'suporte_rating_espera', 'motivoSuporteEsperaContainer');
        setupRatingButtons('.rating-btn-suporte-clareza', 'suporte_rating_clareza', 'motivoSuporteClarezaContainer');
        setupRatingButtons('.rating-btn-suporte-resolucao', 'suporte_rating_resolucao', 'motivoSuporteResolucaoContainer');
        setupRatingButtons('.rating-btn-suporte-tempo-resolucao', 'suporte_rating_tempo_resolucao', 'motivoSuporteTempoResolucaoContainer');
        setupRatingButtons('.rating-btn-geral', 'rating_geral', 'motivoGeralContainer');
        setupRatingButtons('.rating-btn-caixa', 'rating_caixa', 'motivoCaixaContainer');
        setupRatingButtons('.rating-btn-entrega', 'rating_entrega', 'motivoEntregaContainer');

        function showStep(id) {
            currentStepId = id;
            allSteps.forEach(step => step.classList.add('hidden'));
            getStepElement(id).classList.remove('hidden');
            updateProgress();
            updateButtons();
        }

        function updateProgress() {
            const currentPosition = currentFlow.indexOf(currentStepId);
            const progress = ((currentPosition) / (currentFlow.length - 1)) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        function updateButtons() {
            const currentPosition = currentFlow.indexOf(currentStepId);
            const isFirstStep = currentPosition === 0;
            const isLastStep = currentPosition === currentFlow.length - 1;

            prevBtn.classList.toggle('hidden', isFirstStep);
            nextBtn.classList.toggle('hidden', isLastStep);
            submitBtn.classList.toggle('hidden', !isLastStep);
        }
        
        function hideAllErrors() {
            errorStep1?.classList.add('hidden');
            errorStepSuporte?.classList.add('hidden');
            errorStep2?.classList.add('hidden');
            errorSubmit?.classList.add('hidden');
        }

        prevBtn.addEventListener('click', () => {
            const currentPosition = currentFlow.indexOf(currentStepId);
            if (currentPosition > 0) {
                showStep(currentFlow[currentPosition - 1]);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (!validateCurrentStep()) return;

            if (currentStepId === 'step1') {
                const selectedReason = document.querySelector('input[name="contact_reason"]:checked')?.value;
                if (selectedReason === 'suporte') {
                    currentFlow = flowMap.suporte;
                } else if (selectedReason === 'reclamacao') {
                    currentFlow = flowMap.reclamacao;
                } else {
                    currentFlow = flowMap.general;
                }
            }

            const currentPosition = currentFlow.indexOf(currentStepId);
            if (currentPosition < currentFlow.length - 1) {
                showStep(currentFlow[currentPosition + 1]);
            }
        });
        
        function validateCurrentStep() {
            hideAllErrors();
            let canAdvance = true;
            if (currentStepId === 'step1') {
                const reason = document.querySelector('input[name="contact_reason"]:checked');
                if (!reason) {
                    errorStep1.textContent = 'Por favor, selecione o motivo do contacto.';
                    errorStep1.classList.remove('hidden');
                    canAdvance = false;
                } else if (reason.value === 'outro' && !document.querySelector('input[name="other_reason"]').value.trim()) {
                    errorStep1.textContent = 'Por favor, especifique o outro motivo.';
                    errorStep1.classList.remove('hidden');
                    canAdvance = false;
                }
            } else if (currentStepId === 'stepSuporte') {
                
                if (!document.getElementById('suporte_rating_espera').value ||
                    !document.getElementById('suporte_rating_clareza').value || 
                    !document.getElementById('suporte_rating_resolucao').value || 
                    !document.getElementById('suporte_rating_tempo_resolucao').value) {
                    errorStepSuporte.classList.remove('hidden');
                    canAdvance = false;
                }
            } else if (currentStepId === 'step2') {
                if (!document.getElementById('rating_geral').value || !document.getElementById('rating_caixa').value || !document.getElementById('rating_entrega').value) {
                    errorStep2.classList.remove('hidden');
                    canAdvance = false;
                }
            }
            return canAdvance;
        }

        document.querySelectorAll('input[name="contact_reason"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const otherReasonInput = document.querySelector('input[name="other_reason"]');
                otherReasonInput.classList.toggle('hidden', this.value !== 'outro');
                if (this.value === 'outro') otherReasonInput.focus();
                else otherReasonInput.value = '';
            });
        });

        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
        
            submitBtn.disabled = true;
            submitBtn.innerHTML = `<span class="loader"></span> Enviando...`;
            hideAllErrors();
            
            const contactReasonRadio = document.querySelector('input[name="contact_reason"]:checked');
            const contactReason = contactReasonRadio ? contactReasonRadio.value : '';
            const otherReason = document.querySelector('input[name="other_reason"]').value;
            const getMotivos = (name) => Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(cb => cb.value).join(', ');

            const dados = {
                motivo_contato: contactReason === 'outro' ? otherReason : contactReason,
                rating_geral: document.getElementById('rating_geral').value,
                motivo_geral: getMotivos('motivo_geral'),
                rating_caixa: document.getElementById('rating_caixa').value,
                motivo_caixa: getMotivos('motivo_caixa'),
                rating_entrega: document.getElementById('rating_entrega').value,
                motivo_entrega: getMotivos('motivo_entrega'),
                
                suporte_rating_espera: document.getElementById('suporte_rating_espera').value,
                suporte_motivo_espera: getMotivos('motivo_suporte_espera'),
                suporte_rating_clareza: document.getElementById('suporte_rating_clareza').value,
                suporte_motivo_clareza: getMotivos('motivo_suporte_clareza'),
                suporte_rating_resolucao: document.getElementById('suporte_rating_resolucao').value,
                suporte_motivo_resolucao: getMotivos('motivo_suporte_resolucao'),
                suporte_rating_tempo_resolucao: document.getElementById('suporte_rating_tempo_resolucao').value,
                suporte_motivo_tempo_resolucao: getMotivos('motivo_suporte_tempo_resolucao'),
                sugestao: document.querySelector('textarea[name="suggestion"]').value,
                nome: document.getElementById('name').value,
                email: document.getElementById('email').value,
                telefone: document.getElementById('phone').value,
            };

            console.log('Dados a serem enviados:', dados);

            try {
                const resposta = await fetch('http://192.168.1.210:3000/api/respostas', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(dados)
                });
                if (!resposta.ok) {
                    throw new Error(`Erro na requisiÃ§Ã£o: ${resposta.statusText}`);
                }
                
                form.classList.add('hidden');
                document.querySelector('.bg-gradient-to-r').classList.add('hidden');
                thankYou.classList.remove('hidden');
                window.scrollTo({ top: 0, behavior: 'smooth' });

                let countdown = 5;
                const redirectMessage = document.getElementById('redirectMessage');
                
                const interval = setInterval(() => {
                    countdown--;
                    if(redirectMessage) {
                        redirectMessage.textContent = `SerÃ¡ redirecionado para a pÃ¡gina inicial em ${countdown} segundos...`;
                    }
                    if (countdown <= 0) {
                        clearInterval(interval);
                        window.location.href = 'index.html';                     }
                }, 1000);

            } catch (erro) {
                console.error('Erro ao enviar:', erro);
                errorSubmit.textContent = 'Erro ao enviar. Verifique sua conexÃ£o e tente novamente.';
                errorSubmit.classList.remove('hidden');
                
                submitBtn.disabled = false;
                submitBtn.innerHTML = submitBtnHTML;
            }
        });

        showStep('step1');
    });
    </script>
</body>
</html>